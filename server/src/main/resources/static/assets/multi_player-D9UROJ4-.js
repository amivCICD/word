import{w as x,G as T,R as C,b as $,C as N,a as k,t as g,c as E}from"./window_api_url-ixXmvLwt.js";console.log("loaded multi_player/index.html");const w=x;console.log("apiURL	",w);console.log("window.API_URL	",window.API_URL);const R=T.getInstance(),B=C.getInstance(),D=$.getInstance(),y=N.getInstance();B.getMethods();let a;(async()=>{let t;try{if(y.isCompleted()?t=await fetch(`${w}/newgameword`,{method:"GET",headers:{mode:"cors","Content-Type":"application/json"}}):t=await fetch(`${w}/wordoftheday`,{method:"GET",headers:{mode:"cors","Content-Type":"application/json"}}),t.ok){const e=await t.json();a=new k(!0,e.word),a.setResetFalse(),y.isCompleted()&&y.hideRevealStartBtn(!1),g(null,a,a.wordOfTheDay,a.wordOfTheDayLetters)}}catch(e){console.error(e)}})();document.querySelectorAll(".startNewGame").forEach(t=>{t.addEventListener("click",e=>{e&&(async()=>{try{const n=await fetch(`${w}/newgameword`,{method:"GET",headers:{mode:"cors","Content-Type":"application/json"}});if(n.ok){const s=await n.json();console.log("fetchWord	",s),a=new k(!0,s.word),y.isCompleted()&&y.setCompletedGame(),R.setGameOverFalse(),g(null,a,a.wordOfTheDay,a.wordOfTheDayLetters),a.setResetFalse()}}catch(n){console.error(n)}})()})});document.addEventListener("keydown",t=>{if(window.textMessageOnly||window.usernameInputOnly||B.getRowLetterCount()===5&&D.getGuessStarted())return;let e=E(t.key.toUpperCase());g(e,a,a.wordOfTheDay,a.wordOfTheDayLetters),document.querySelectorAll(".kbd").forEach(n=>{e===n.innerHTML&&n.classList.add("bg-pink-200")})});document.addEventListener("keyup",t=>{let e=E(t.key.toUpperCase());document.querySelectorAll(".kbd").forEach(n=>{e===n.innerHTML&&n.classList.remove("bg-pink-200")})});const G=Array.from(document.querySelectorAll(".kbd")).filter(t=>t.id.toLowerCase()!=="enter"&&t.id.toLowerCase()!=="backspace");G.forEach(t=>{t.addEventListener("click",e=>{let n=e.target.innerHTML,s=E(n);g(s,a,a.wordOfTheDay,a.wordOfTheDayLetters)}),t.addEventListener("mousedown",e=>{e.target.classList.add("bg-pink-200")}),t.addEventListener("mouseup",e=>{e.target.classList.remove("bg-pink-200")})});document==null||document.getElementById("backspace").addEventListener("click",t=>{g("BACKSPACE",a,a.wordOfTheDay,a.wordOfTheDayLetters)});document==null||document.getElementById("enter").addEventListener("click",t=>{g("ENTER",a,a.wordOfTheDay,a.wordOfTheDayLetters)});document==null||document.getElementById("backspace").addEventListener("mousedown",t=>{t.target.classList.add("bg-pink-200")});document==null||document.getElementById("enter").addEventListener("mousedown",t=>{t.target.classList.add("bg-pink-200")});document==null||document.getElementById("backspace").addEventListener("mouseup",t=>{t.target.classList.remove("bg-pink-200")});document==null||document.getElementById("enter").addEventListener("mouseup",t=>{t.target.classList.remove("bg-pink-200")});const J="localhost:1985";let l=null,S=null;function v(t){return l&&l.readyState===WebSocket.OPEN&&S===t||(l&&l.close(),S=t,l=new WebSocket(`ws://${J}/chat?room=${t}`),l.onopen=()=>console.log("connected to web sockets!"),l.onclose=e=>console.log("Disconnected...	",e.code,e.reason),l.onerror=e=>console.log("ERROR: 	",e.message||e)),l}function O(){return l||console.error("WebSocket not initialized. Call initializeWebSocket first..."),l}function M(t){l&&l.readyState===WebSocket.OPEN?l.send(t):console.error("Cannot send: WebSocket not open...")}function P(t){l&&(l.onmessage=e=>{t(e.data),console.log(`Message: ${e.data}`)})}let m="";(function(){var e;(e=document.getElementById("textMessageInput"))==null||e.addEventListener("input",n=>{m=n.target.value}),document.getElementById("sendTextBtn").addEventListener("click",()=>{const n=O();if(n.readyState===WebSocket.OPEN){let s,d;if(m==="")return;if(localStorage.getItem("username")!==null){let r=JSON.parse(localStorage.getItem("username"));s=r.username,d=r.id}else{localStorage.setItem("username",JSON.stringify({username:"tempname",id:Date.now()}));let r=JSON.parse(localStorage.getItem("username"));s=r.username,d=r.id}n.send(JSON.stringify({type:"text",username:s,id:d,message:m})),n.onmessage=r=>{var p;let u=document.createElement("div");console.log("e.data	",JSON.parse(r.data));const o=JSON.parse(r.data);o.username.id!==s.id?u.innerHTML=`
                    <div class="chat chat-end">
                        <div class="chat-bubble bg-green-300 text-white"><span class="font-bold">${o.username}</span>: ${o.message}</div>
                    </div>
                    `:u.innerHTML=`
                    <div class="chat chat-start">
                        <div class="chat-bubble bg-pink-300 text-white"><span class="font-bold">${o.username}</span>: ${o.message}</div>
                    </div>
                    `,(p=document.getElementById("textMessages"))==null||p.appendChild(u);const f=document.getElementById("textMessages");f.scrollTo(0,f.scrollHeight)};const c=document.getElementById("textMessageInput");c.value="",m="",c==null||c.focus()}else console.warn("Web socket is not open... Current state: ",n.readyState),alert("Chat unavailable at the moment, try again in 2 seconds...")})})();(function(){document.addEventListener("keyup",e=>{if(window.usernameInputOnly&&document.getElementById("usernameInput").value!==""&&e.keyCode===13){let s=document.getElementById("confirmUsernameBtn");s==null||s.click();return}if(console.log("e.keyCode	",e.keyCode),!!window.textMessageOnly&&e.keyCode===13&&e.keyCode===13&&window.textMessageOnly){const n=O();if((n==null?void 0:n.readyState)===WebSocket.OPEN){let s,d;const c=document.getElementById("textMessageInput");if(c.value==="")return;if(localStorage.getItem("username")!==null){let r=JSON.parse(localStorage.getItem("username"));s=r.username,d=r.id}else{localStorage.setItem("username",JSON.stringify({username:"tempname",id:Date.now()}));let r=JSON.parse(localStorage.getItem("username"));s=r.username,d=r.id}n.send(JSON.stringify({type:"text",username:s,id:d,message:m})),n.onmessage=r=>{var p;let u=document.createElement("div");console.log("e.data	",JSON.parse(r.data));const o=JSON.parse(r.data);console.log("data	",o),console.log("data?.username	",o==null?void 0:o.username),console.log("data?.username.id	",o==null?void 0:o.username.id),o.username.id!==s.id?u.innerHTML=`
                        <div class="chat chat-end">
                            <div class="chat-bubble bg-green-300 text-white"><span class="font-bold">${o.username}</span>: ${o.message}</div>
                        </div>
                        `:u.innerHTML=`
                        <div class="chat chat-start">
                            <div class="chat-bubble bg-pink-300 text-white"><span class="font-bold">${o.username}</span>: ${o.message}</div>
                        </div>
                        `,(p=document.getElementById("textMessages"))==null||p.appendChild(u);const f=document.getElementById("textMessages");f.scrollTo(0,f.scrollHeight)},c.value="",m="",c==null||c.focus()}else console.warn("Web socket is not open... Current state: ",n==null?void 0:n.readyState),alert("Chat unavailable at the moment, try again in 2 seconds...")}})})();(function(){var n,s;let e=!1;(n=document.getElementById("textMessageInput"))==null||n.addEventListener("focus",d=>{d&&(e=!0,window.textMessageOnly=e,console.log(e))}),(s=document.getElementById("textMessageInput"))==null||s.addEventListener("blur",d=>{d&&(e=!1,window.textMessageOnly=e,console.log(e))})})();document.querySelector(".collapse").addEventListener("click",t=>{var e;(e=document.getElementById("sendTextBtn"))==null||e.classList.toggle("fadeIn")});var b;(b=document.getElementById("arrowBar"))==null||b.addEventListener("click",t=>{let e=document.getElementById("arrowDown"),n=document.getElementById("arrowUp");n==null||n.classList.toggle("hidden"),e==null||e.classList.toggle("hidden")});(function(){var n,s;let e=!1;(n=document.getElementById("usernameInput"))==null||n.addEventListener("focus",d=>{d&&(e=!0,window.usernameInputOnly=e,console.log(e))}),(s=document.getElementById("usernameInput"))==null||s.addEventListener("blur",d=>{d&&(e=!1,window.usernameInputOnly=e,console.log(e))})})();const I=function(){let e=!1;const n=localStorage.getItem("username");if(n!=null){const s=JSON.parse(localStorage==null?void 0:localStorage.getItem("username"));return e=s==null?void 0:s.username,M({type:"usernameUpdate",message:e}),e}else console.warn("Username not yet set!");return e}(),h=document.getElementById("cancelUsernameDialog");h==null||h.addEventListener("click",t=>{var n;t.preventDefault(),(t&&localStorage.getItem("username")===null||localStorage.getItem("username")===void 0)&&document.getElementById("arrowBar").click();const e=document.getElementById("usernameInput");e.value="",(n=document.getElementById("usernamePrompt"))==null||n.close()});const U=function(){return`room_${Math.random().toString(36).substr(2,9)}`}();let W=document.getElementById("confirmUsernameBtn"),i=document.getElementById("usernameInput");W.addEventListener("click",()=>{if(console.log("usernameInput.value	",i.value),i.value===""||i.value===void 0||i.value===null){const t=document.getElementById("usernameRequiredToolTip");t==null||t.classList.toggle("hidden"),setTimeout(()=>{t==null||t.classList.toggle("hidden")},5e3);return}if(i.value!==""||i.value!==void 0||i.value!==null){localStorage.setItem("username",JSON.stringify({username:i.value,id:Date.now()})),console.log("usernameInput.value:	",i.value),v(U);const t=document.getElementById("usernamePrompt");t==null||t.close(),i.value=""}});if(localStorage.getItem("username")!==null){const t=JSON.parse(localStorage.getItem("username")),e=t.username,n=t.id;console.log(`username ${e} userID: ${n}`),M(JSON.stringify({type:"join",username:e,id:n})),P(s=>console.log(`event socket.onmessage:	${s}`))}console.log("usernameExists	",I);document.addEventListener("DOMContentLoaded",()=>{if(document.getElementById("usernamePrompt").showModal(),I){const t=document.getElementById("confirmUsernameBtn");t==null||t.classList.add("hidden");const e=document.getElementById("startGameButton");e==null||e.classList.remove("hidden");const n=document.getElementById("usernameMessage");n.innerHTML=`
        Current username: <span class="text-xl font-extrabold italic text-green-300">${I}</span>
        `;const s=document.getElementById("usernameInput");s.value=I,s.placeholder="change username"}});const A=function(){return`room_${Math.random().toString(36).substr(2,9)}`}();(function(t){var e;console.log("roomId from playMultiPlayer event listener	",t),(e=document.getElementById("startGameButton"))==null||e.addEventListener("click",()=>{const n="/multi_player/";console.log("window.location.origin	",window.location.origin);const s=`${window.location.origin}${n}chat?room=${t}`;console.log("url	",s),history.pushState({},"",s),v(t)})})(A);const H=new URLSearchParams(window.location.search),L=H.get("room");L&&window.location.pathname.includes("/multi_player/chat")&&v(L);
